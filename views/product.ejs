<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Display Single Product Page</title>

    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Link stylesheets here-->
    <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" />
    <link rel="stylesheet" href="/vendor/border-box.css" />
    <link rel="stylesheet" href="/styles/product.css" />
    <link rel="stylesheet" href="/styles/layout.css" />

    <!-- Font awesome-->
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css"
    integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

    <!-- Link scripts here-->
    <script src="/vendor/jquery-3.0.0.js"></script>
    <script src="/scripts/messages.js"></script>
    <script src="/scripts/stock.js"></script>
    <script src="/scripts/favourite.js"></script>
  </head>

  <body>
    <!-- Add the header -->
    <%- include('partials/_header') %>

    <h1>Display Single Product Page</h1>

    <!-- Example using EJS: Display the product name -->
    <h2><%= product["name"] %></h2>

    <!-- Display the product image -->
    <img src=<%= product["photo_url"] %> alt="Product" width="500">



     <!-- IN STOCK feature -->
     <h2 id="in-stock">IN STOCK</h2>
    <% if(isAuthorized){ %>
      <button id="isSold">SOLD</button>
   <% } %>

       <!-- Heart for font awseome-->
       <form method="post" action="/api/favourites">
        <input type="hidden" value="<%= product["id"]%>" name="productId" />
        <button id="notLiked"><i class="fa-regular fa-heart fa-2xl"></i></button>
        <!-- <i id="liked" class="fa-solid fa-heart fa-2xl"fa-2xl></i> -->
      </form>


    <ul>
      <!-- Iterate through the product attributes and display them -->
      <% for(const info in product) { %> <%= info %>: <%= product[info] %>
      <br />
      <% } %>
    </ul>
    <!----------------------Adding a remove product button ----------------->
    <% if(isAuthorized){ %>
    <div class="remove-product">
      <form id="del" action="/api/products/delete" method="post">
        <input type="hidden" value="<%= product["id"]%>" name="productId" />
        <button type="submit">Remove product</button>
      </form>
    </div>
       <% } %>


    <!------------ Adding a new message------------->
    <div class="new-message">
      <h2>New Message</h2>
      <form id="messsage-form" class='form-group' action="/api/messages" method="post">
        <textarea name="text" rows="1" cols="50"></textarea>
        <input type="hidden" value="<%= userId %>" name="userid" />
        <input type="hidden" value="<%=productid%>" name="productid" />
        <button value="<%=method["app"]%>" type="submit">SEND</button>
            <!------------ Adding a new message------------->
            <% if(isAuthorized){ %>
            <input type="submit" value="<%=method["email"]%>" />
            <button value="<%=method["message"]%>"  id="message" type="submit">SEND MESSAGE</button>
            <% } %>
      </form>
      <div class="message-container">
        <ul id="list-messages"></ul>
      </div>
    </div>
  </body>
</html>
